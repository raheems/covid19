<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Report 4 Projections | COVID-19 Live Report</title>
  <meta name="description" content="Live report on COVID-19 pandemic a.k.a. SARS-CoV2 with emphasis on data visualizations and interpretations. The report is focused on current situation in Bangladesh and the aftermath of COVID-19." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Report 4 Projections | COVID-19 Live Report" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="https://covid19.eraheem.com/images/cover.png" />
  <meta property="og:description" content="Live report on COVID-19 pandemic a.k.a. SARS-CoV2 with emphasis on data visualizations and interpretations. The report is focused on current situation in Bangladesh and the aftermath of COVID-19." />
  <meta name="github-repo" content="raheems/covid19" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Report 4 Projections | COVID-19 Live Report" />
  
  <meta name="twitter:description" content="Live report on COVID-19 pandemic a.k.a. SARS-CoV2 with emphasis on data visualizations and interpretations. The report is focused on current situation in Bangladesh and the aftermath of COVID-19." />
  <meta name="twitter:image" content="https://covid19.eraheem.com/images/cover.png" />

<meta name="author" content="Enayetur Raheem, Ph.D." />


<meta name="date" content="2020-06-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bangladesh.html"/>
<link rel="next" href="scipubs.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-684495-31"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-684495-31');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">COVID19 Live Report</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this report</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i>Disclaimer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i>Purpose</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#volunteering-opportunity"><i class="fa fa-check"></i>Volunteering opportunity</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-skills-are-useful"><i class="fa fa-check"></i>What skills are useful</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#found-an-error"><i class="fa fa-check"></i>Found an error?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="world.html"><a href="world.html"><i class="fa fa-check"></i><b>1</b> World</a><ul>
<li class="chapter" data-level="1.1" data-path="world.html"><a href="world.html#incidence-recovery-death"><i class="fa fa-check"></i><b>1.1</b> Daily Incidence, Recovery, Deaths</a></li>
<li class="chapter" data-level="1.2" data-path="world.html"><a href="world.html#world-case-fatality"><i class="fa fa-check"></i><b>1.2</b> Case Fatality Rate</a><ul>
<li class="chapter" data-level="1.2.1" data-path="world.html"><a href="world.html#case-fatality-rate-select-countries"><i class="fa fa-check"></i><b>1.2.1</b> Case Fatality Rate (select countries)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="world.html"><a href="world.html#confirmed-cases"><i class="fa fa-check"></i><b>1.3</b> Confirmed Cases</a></li>
<li class="chapter" data-level="1.4" data-path="world.html"><a href="world.html#deaths-since-first-death"><i class="fa fa-check"></i><b>1.4</b> Deaths since first death</a></li>
<li class="chapter" data-level="1.5" data-path="world.html"><a href="world.html#deaths-since-first-confirmed-case"><i class="fa fa-check"></i><b>1.5</b> Deaths since first confirmed case</a><ul>
<li class="chapter" data-level="1.5.1" data-path="world.html"><a href="world.html#cases-and-deaths-compared-on-a-specific-day"><i class="fa fa-check"></i><b>1.5.1</b> Cases and deaths compared on a specific day</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="world.html"><a href="world.html#recovery-death-ratio"><i class="fa fa-check"></i><b>1.6</b> Recovery-to-death ratio</a><ul>
<li class="chapter" data-level="1.6.1" data-path="world.html"><a href="world.html#recovery-to-death-ratio-south-and-south-east-asia"><i class="fa fa-check"></i><b>1.6.1</b> Recovery-to-death ratio (South and South-East Asia)</a></li>
<li class="chapter" data-level="1.6.2" data-path="world.html"><a href="world.html#recovery-to-death-ratio-middle-east"><i class="fa fa-check"></i><b>1.6.2</b> Recovery-to-death ratio (Middle East)</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="world.html"><a href="world.html#perc-change-top6"><i class="fa fa-check"></i><b>1.7</b> 3-day % changes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="usa.html"><a href="usa.html"><i class="fa fa-check"></i><b>2</b> USA</a><ul>
<li class="chapter" data-level="2.1" data-path="usa.html"><a href="usa.html#us-overall"><i class="fa fa-check"></i><b>2.1</b> Overall trend</a></li>
<li class="chapter" data-level="2.2" data-path="usa.html"><a href="usa.html#confirmed-cases-1"><i class="fa fa-check"></i><b>2.2</b> Confirmed Cases</a></li>
<li class="chapter" data-level="2.3" data-path="usa.html"><a href="usa.html#deaths"><i class="fa fa-check"></i><b>2.3</b> Deaths</a></li>
<li class="chapter" data-level="2.4" data-path="usa.html"><a href="usa.html#usa-daily-deaths"><i class="fa fa-check"></i><b>2.4</b> Daily Deaths</a></li>
<li class="chapter" data-level="2.5" data-path="usa.html"><a href="usa.html#usa-daily-deaths-excl-ny"><i class="fa fa-check"></i><b>2.5</b> Daily Deaths excluding NY</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bangladesh.html"><a href="bangladesh.html"><i class="fa fa-check"></i><b>3</b> Bangladesh</a><ul>
<li class="chapter" data-level="3.1" data-path="bangladesh.html"><a href="bangladesh.html#epidemic-curve-and-search-for-peak"><i class="fa fa-check"></i><b>3.1</b> Epidemic curve and search for peak</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bangladesh.html"><a href="bangladesh.html#estimating-the-overall-reproduction-number-r_0"><i class="fa fa-check"></i><b>3.1.1</b> Estimating the Overall Reproduction Number, <span class="math inline">\(R_0\)</span></a></li>
<li class="chapter" data-level="3.1.2" data-path="bangladesh.html"><a href="bangladesh.html#estimating-the-effectuve-reproduction-number-r_e"><i class="fa fa-check"></i><b>3.1.2</b> Estimating the Effectuve Reproduction Number (<span class="math inline">\(R_e\)</span>)</a></li>
<li class="chapter" data-level="3.1.3" data-path="bangladesh.html"><a href="bangladesh.html#simulating-the-r_e-on-weekly-sliding-window"><i class="fa fa-check"></i><b>3.1.3</b> Simulating the <span class="math inline">\(R_e\)</span> on Weekly Sliding Window</a></li>
<li class="chapter" data-level="3.1.4" data-path="bangladesh.html"><a href="bangladesh.html#simulating-r_e-on-a-monthly-sliding-window"><i class="fa fa-check"></i><b>3.1.4</b> Simulating <span class="math inline">\(R_e\)</span> on a Monthly Sliding Window</a></li>
<li class="chapter" data-level="3.1.5" data-path="bangladesh.html"><a href="bangladesh.html#cumulative-deaths-official-and-unofficial"><i class="fa fa-check"></i><b>3.1.5</b> Cumulative Deaths (official and unofficial)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bangladesh.html"><a href="bangladesh.html#bangladesh-in-south-asia"><i class="fa fa-check"></i><b>3.2</b> Bangladesh in South Asia</a><ul>
<li class="chapter" data-level="3.2.1" data-path="bangladesh.html"><a href="bangladesh.html#infection"><i class="fa fa-check"></i><b>3.2.1</b> Infection</a></li>
<li class="chapter" data-level="3.2.2" data-path="bangladesh.html"><a href="bangladesh.html#deaths-1"><i class="fa fa-check"></i><b>3.2.2</b> Deaths</a></li>
<li class="chapter" data-level="3.2.3" data-path="bangladesh.html"><a href="bangladesh.html#cases-and-deaths-compared-on-a-specific-day-1"><i class="fa fa-check"></i><b>3.2.3</b> Cases and deaths compared on a specific day</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="projection.html"><a href="projection.html"><i class="fa fa-check"></i><b>4</b> Projections</a><ul>
<li class="chapter" data-level="4.1" data-path="projection.html"><a href="projection.html#projection-bangladesh-run1"><i class="fa fa-check"></i><b>4.1</b> Projection for Bangladesh (unofficial) Run1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="projection.html"><a href="projection.html#methodology"><i class="fa fa-check"></i><b>4.1.1</b> Methodology</a></li>
<li class="chapter" data-level="4.1.2" data-path="projection.html"><a href="projection.html#ascertainment-rate"><i class="fa fa-check"></i><b>4.1.2</b> Ascertainment Rate</a></li>
<li class="chapter" data-level="4.1.3" data-path="projection.html"><a href="projection.html#projection-for-the-next-5-days"><i class="fa fa-check"></i><b>4.1.3</b> Projection for the next 5 days</a></li>
<li class="chapter" data-level="4.1.4" data-path="projection.html"><a href="projection.html#projection-for-100-days-into-the-future"><i class="fa fa-check"></i><b>4.1.4</b> Projection for 100 days into the future</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="projection.html"><a href="projection.html#projection-bangladesh-run2"><i class="fa fa-check"></i><b>4.2</b> Projection for Bangladesh (unofficial) Run 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="projection.html"><a href="projection.html#projection-for-the-next-5-days-1"><i class="fa fa-check"></i><b>4.2.1</b> Projection for the next 5 days</a></li>
<li class="chapter" data-level="4.2.2" data-path="projection.html"><a href="projection.html#projection-for-100-days-into-the-future-1"><i class="fa fa-check"></i><b>4.2.2</b> Projection for 100 days into the future</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scipubs.html"><a href="scipubs.html"><i class="fa fa-check"></i><b>5</b> Publications</a><ul>
<li class="chapter" data-level="5.1" data-path="scipubs.html"><a href="scipubs.html#other-articles"><i class="fa fa-check"></i><b>5.1</b> Other articles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stories.html"><a href="stories.html"><i class="fa fa-check"></i><b>6</b> Stories</a><ul>
<li class="chapter" data-level="6.1" data-path="stories.html"><a href="stories.html#rumi-ahmed"><i class="fa fa-check"></i><b>6.1</b> Rumi Ahmed</a><ul>
<li class="chapter" data-level="6.1.1" data-path="stories.html"><a href="stories.html#april-7-2020-via-facebook"><i class="fa fa-check"></i><b>6.1.1</b> April 7, 2020 (via Facebook)</a></li>
<li class="chapter" data-level="6.1.2" data-path="stories.html"><a href="stories.html#april-16-2020---bats-via-facebook"><i class="fa fa-check"></i><b>6.1.2</b> April 16, 2020 - Bats (via Facebook)</a></li>
<li class="chapter" data-level="6.1.3" data-path="stories.html"><a href="stories.html#april-21-2020---bats-part-2-and-3"><i class="fa fa-check"></i><b>6.1.3</b> April 21, 2020 - Bats (Part 2 and 3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="trials.html"><a href="trials.html"><i class="fa fa-check"></i><b>7</b> Trials and Treatments</a><ul>
<li class="chapter" data-level="7.1" data-path="trials.html"><a href="trials.html#clinical-trials"><i class="fa fa-check"></i><b>7.1</b> Clinical trials</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>8</b> Resources</a><ul>
<li class="chapter" data-level="8.1" data-path="resources.html"><a href="resources.html#data-sources"><i class="fa fa-check"></i><b>8.1</b> Data Sources</a></li>
<li class="chapter" data-level="8.2" data-path="resources.html"><a href="resources.html#computational-resources"><i class="fa fa-check"></i><b>8.2</b> Computational Resources</a></li>
<li class="chapter" data-level="8.3" data-path="resources.html"><a href="resources.html#dashboards"><i class="fa fa-check"></i><b>8.3</b> Dashboards</a></li>
<li class="chapter" data-level="8.4" data-path="resources.html"><a href="resources.html#dashboards-from-bangladesh"><i class="fa fa-check"></i><b>8.4</b> Dashboards from Bangladesh</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/raheems/covid19" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">COVID-19 Live Report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projection" class="section level1">
<h1><span class="header-section-number">Report 4</span> Projections</h1>
<p><strong>Report last updated:</strong> 2020-06-16</p>
<ul>
<li><p>In this udpate, second round of prjections (Run 2) have been added. Please scroll down to find the projections. As usual, the last two current values were not used for fitting the model. Also, the model is conservative/pessimistic i.e., it slightly overestimates new cases.</p></li>
<li><p>In addition to that, a new paramter to control the <code>run_date</code> was added to the <code>fit_seir()</code> function. See the code for more details.</p></li>
</ul>
<div id="projection-bangladesh-run1" class="section level2">
<h2><span class="header-section-number">4.1</span> Projection for Bangladesh (unofficial) Run1</h2>
<p><strong>Run date</strong>: 17 April 2020</p>
<p>This is a dynamic document and will be updated frequently. Please check back for latest projection. This projection is based on unofficial Bangladesh incidence data.</p>
<div id="methodology" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Methodology</h3>
<p>This projection is based on an SEIR model. Here, the <strong>S</strong> stands for Susceptible, <strong>E</strong> stands for Exposed/infected but asymptomatic, <strong>I</strong> stands for Infected <strong>and</strong> symptomatic, and <strong>R</strong> stands for Recovered. N is the population size.</p>
<p>Assuming there is no births or deaths in a population, (known as a closed population), the model is formulated by the following differential equations.</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial S}{\partial t} &amp; = -\frac{\beta I S}{N} \\
\frac{\partial E}{\partial t} &amp;= \frac{\beta I S}{N} -\sigma E \\
\frac{\partial I}{\partial t} &amp;= \sigma E - \gamma I \\
\frac{\partial R}{\partial t} &amp;= \gamma I
\end{align}
\]</span></p>
<p>Here the parameters <span class="math inline">\(\beta\)</span> controls the transmission rate, which is the product of contact rate and the probability of transmission given contact betwen S and E compartments. <span class="math inline">\(\sigma\)</span> controls the transition from E to I, and <span class="math inline">\(\gamma\)</span> controls the transition from I to R.</p>
<p>The reproduction rate, <span class="math inline">\(R_0\)</span> can be approximated by <span class="math display">\[R_0 = \frac{\beta}{\gamma}\]</span> In plain language, <span class="math inline">\(R_0\)</span> tells us how many people are infected from one patient. An <span class="math inline">\(R_0&gt;1\)</span> indicates the epidemic is at the grotwh phase. <span class="math inline">\(R_0&lt;1\)</span> means the epidemic is slowing or decaying.</p>
<p>Model was fitted using all but the last two day’s incidences to obtain the estimated <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>. The fitted model was used for prediction. This post was inspired by <span class="citation">Churches (<a href="#ref-churches2020covid19rpart1">2020</a>)</span>, where you will find some details on the computation.</p>
</div>
<div id="ascertainment-rate" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Ascertainment Rate</h3>
<p>Not all the cases are reported or tested. Usually a fraction of the actual cases are detected. This is known as ascertainment rate. We consider 25%, 50%, 75% amd 90% ascertainment rate when fitting the model.</p>
<p>Simply, the incidences are inflated by the inverse of the ascertainment rate.</p>
<p>Please let me know if you find any error in it. The code was adapted from <span class="citation">Churches (<a href="#ref-churches2020covid19rpart1">2020</a>)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(deSolve)
<span class="kw">library</span>(grid)
<span class="kw">library</span>(gridExtra)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">######################################
## SIER Modeling -------
######################################
<span class="co"># Parameters</span>
<span class="co"># beta = rate of expusore from susceptible infected contact </span>
<span class="co"># sigma = rate at which exposed person becomes infected</span>
<span class="co"># gamma = rate at which infected person recovers</span>
<span class="co"># S = Initial susceptible population</span>
<span class="co"># E = Initial exposed population</span>
<span class="co"># I = Initial infected population</span>
<span class="co"># R = Recovered population</span>

fit_seir &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">country_name=</span><span class="st">&#39;Bangladesh(unoff)&#39;</span>, 
                     <span class="dt">N=</span><span class="dv">170000000</span>, 
                     <span class="dt">af=</span><span class="fl">0.5</span>, <span class="dt">npast=</span><span class="dv">2</span>, <span class="dt">nfuture=</span><span class="dv">5</span>, 
                     <span class="dt">run_date =</span> <span class="kw">today</span>()){
  <span class="co"># country = Country name</span>
  <span class="co"># N = population size of the country</span>
  <span class="co"># af = ascertainment factor, default = 0.5</span>
  <span class="co"># country = &quot;Bangladesh(unoff)&quot;</span>
  <span class="co"># npast = number of days in the past to exclude when fitting the model</span>
  <span class="co"># default is npast = 2</span>
  <span class="co"># nfuture = number of days in the future the algorithm to predict to</span>
  <span class="co"># default is nfuture=5</span>
  <span class="co"># run_date = sets the cutoff date so that the later runs do not overrite</span>
  <span class="co"># previous runs. Default is today()</span>
  
  SEIR &lt;-<span class="st"> </span><span class="cf">function</span>(time, state, parameters) {
    par &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">c</span>(state, parameters))
    <span class="kw">with</span>(par, {
      dS &lt;-<span class="st"> </span><span class="op">-</span>beta <span class="op">*</span><span class="st"> </span>I <span class="op">*</span><span class="st"> </span>S<span class="op">/</span>N
      dE &lt;-<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>I <span class="op">*</span><span class="st"> </span>S<span class="op">/</span>N <span class="op">-</span><span class="st"> </span>sigma <span class="op">*</span><span class="st"> </span>E
      dI &lt;-<span class="st"> </span>sigma <span class="op">*</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I
      dR &lt;-<span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I
      <span class="kw">list</span>(<span class="kw">c</span>(dS, dE, dI, dR))
    })
  }

  <span class="co"># define a function to calculate the residual sum of squares</span>
  <span class="co"># (RSS), passing in parameters beta and gamma that are to be</span>
  <span class="co"># optimised for the best fit to the incidence data</span>
  
  RSS &lt;-<span class="st"> </span><span class="cf">function</span>(parameters) {
    <span class="kw">names</span>(parameters) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>)
    out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> init, <span class="dt">times =</span> Day, <span class="dt">func =</span> SEIR, <span class="dt">parms =</span> parameters)
    fit &lt;-<span class="st"> </span>out[, <span class="dv">4</span>]
    <span class="kw">sum</span>((infected <span class="op">-</span><span class="st"> </span>fit)<span class="op">^</span><span class="dv">2</span>)
  }
  
  country =<span class="st"> </span><span class="kw">enquo</span>(country_name)
  
  df &lt;-<span class="st"> </span>bd_unoff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> </span><span class="op">!!</span>country, cum_cases<span class="op">&gt;</span><span class="dv">0</span>, date <span class="op">&lt;=</span><span class="st"> </span>run_date)
  infected &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">min</span>(date), date <span class="op">&lt;=</span><span class="st"> </span><span class="kw">today</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>npast) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">pull</span>(cum_cases)
  
  R =<span class="st"> </span><span class="dv">0</span>; E=<span class="dv">0</span>; I =<span class="st"> </span>infected[<span class="dv">1</span>]; S =<span class="st"> </span>N <span class="op">-</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>R
  
  seir_start_date &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">min</span>()
  
  <span class="co"># Ascertainment factor</span>
  infected =<span class="st"> </span>infected <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>af
  
  <span class="co"># Create an incrementing Day vector the same length as our</span>
  <span class="co"># cases vector</span>
  Day &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(infected))
  
  <span class="co"># now specify initial values for S, I and R</span>
  init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> S, <span class="dt">E=</span>E, <span class="dt">I=</span>I, <span class="dt">R=</span>R)
  
  <span class="co"># now find the values of beta and gamma that give the</span>
  <span class="co"># smallest RSS, which represents the best fit to the data.</span>
  <span class="co"># Start with values of 0.5 for each, and constrain them to</span>
  <span class="co"># the interval 0 to 1.0</span>
  
  opt &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>), RSS, <span class="dt">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>, 
               <span class="dt">lower =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>), <span class="dt">upper =</span> <span class="kw">c</span>(.<span class="dv">999</span>, .<span class="dv">999</span>, .<span class="dv">999</span>), 
               <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">1000</span>))
  
  <span class="co"># check for convergence</span>
  opt_msg =<span class="st"> </span>opt<span class="op">$</span>message
  opt_par &lt;-<span class="st"> </span><span class="kw">setNames</span>(opt<span class="op">$</span>par, <span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>))

  beta =<span class="st"> </span>opt_par[<span class="st">&quot;beta&quot;</span>]
  gamma =<span class="st"> </span>opt_par[<span class="st">&quot;gamma&quot;</span>]
  sigma =<span class="st"> </span>opt_par[<span class="st">&quot;sigma&quot;</span>]
  R0 =<span class="st"> </span><span class="kw">as.numeric</span>(beta<span class="op">/</span>gamma)
  
  
  <span class="co"># time in days for predictions</span>
  t &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(<span class="kw">as.integer</span>(<span class="kw">today</span>() <span class="op">-</span><span class="st"> </span>seir_start_date)  <span class="op">+</span><span class="st"> </span>nfuture)
  
  <span class="co"># get the fitted values from our SEIR model</span>
  
  odefit =<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> init, <span class="dt">times =</span> t, <span class="dt">func =</span> SEIR, <span class="dt">parms =</span> opt_par)
  fitted_cases &lt;-<span class="st"> </span><span class="kw">data.frame</span>(odefit)
  
  <span class="co"># add a Date column and join the observed incidence data</span>
  fitted_cases &lt;-<span class="st"> </span>fitted_cases <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">date =</span> seir_start_date <span class="op">+</span><span class="st"> </span><span class="kw">days</span>(t <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">left_join</span>(df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(cum_cases<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">                </span><span class="kw">select</span>(date, cum_cases))
  
  <span class="co"># Return</span>
  <span class="kw">list</span>(<span class="dt">country=</span>country_name, <span class="dt">infected =</span> infected,
       <span class="dt">opt_msg=</span>opt_msg, <span class="dt">opt_par =</span> opt_par, <span class="dt">R0=</span>R0, <span class="dt">opt_msg=</span>opt_msg, 
       <span class="dt">fitted_cases=</span>fitted_cases, <span class="dt">N=</span>N, <span class="dt">af=</span>af)
  
}</code></pre></div>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-1.png" width="960" /></p>
<p>It turns out that the bottom left one fits the current data best. So lets put that figure on a bigger canvas.</p>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-best-1.png" width="960" /></p>
</div>
<div id="projection-for-the-next-5-days" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Projection for the next 5 days</h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-27">Table 4.1: </span>Predicted new cases for the next 5 days
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Actual daily cases
</th>
<th style="text-align:right;">
Projected daily cases
</th>
<th style="text-align:right;">
Actual cumulative cases
</th>
<th style="text-align:right;">
Projected cumulative cases
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
2020-04-12
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
621
</td>
<td style="text-align:right;">
840
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
2020-04-13
</td>
<td style="text-align:right;">
182
</td>
<td style="text-align:right;">
172
</td>
<td style="text-align:right;">
803
</td>
<td style="text-align:right;">
1012
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
2020-04-14
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
1012
</td>
<td style="text-align:right;">
1218
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
2020-04-15
</td>
<td style="text-align:right;">
219
</td>
<td style="text-align:right;">
248
</td>
<td style="text-align:right;">
1231
</td>
<td style="text-align:right;">
1466
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
2020-04-16
</td>
<td style="text-align:right;">
341
</td>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
1572
</td>
<td style="text-align:right;">
1764
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
2020-04-17
</td>
<td style="text-align:right;">
266
</td>
<td style="text-align:right;">
359
</td>
<td style="text-align:right;">
1838
</td>
<td style="text-align:right;">
2123
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
2020-04-18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
433
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2556
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
2020-04-19
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3077
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
2020-04-20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
626
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3703
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
2020-04-21
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
754
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4457
</td>
</tr>
</tbody>
</table>
</div>
<div id="projection-for-100-days-into-the-future" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Projection for 100 days into the future</h3>
<p>Assuming the situation will remain like this including the interventions currently in place, the 100 day projection suggests that the the peak of the epidemic will be around the middle of June. The trajectory also suggests that the epidemic will end by end of July or early August.</p>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-100-1.png" width="960" /></p>
</div>
</div>
<div id="projection-bangladesh-run2" class="section level2">
<h2><span class="header-section-number">4.2</span> Projection for Bangladesh (unofficial) Run 2</h2>
<p><strong>Run date</strong>: 21 April 2020</p>
<p>This is the second projection. For the initial project, please scroll up. The methodology is discussed above.</p>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-run2-1.png" width="960" /></p>
<p>It turns out that the bottom right one fits the current data best. So lets put that figure on a bigger canvas. Please note that in Run 1, we used a similar <span class="math inline">\(R_0\)</span> but a lower ascertainment rate. This time, a higher ascertainment rate is associated with a similar <span class="math inline">\(R_0\)</span>.</p>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-best-run2-1.png" width="960" /></p>
<div id="projection-for-the-next-5-days-1" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Projection for the next 5 days</h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-28">Table 4.2: </span>Predicted new cases for the next 5 days
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Actual daily cases
</th>
<th style="text-align:right;">
Projected daily cases
</th>
<th style="text-align:right;">
Actual cumulative cases
</th>
<th style="text-align:right;">
Projected cumulative cases
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
2020-04-14
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
1012
</td>
<td style="text-align:right;">
1132
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
2020-04-15
</td>
<td style="text-align:right;">
219
</td>
<td style="text-align:right;">
228
</td>
<td style="text-align:right;">
1231
</td>
<td style="text-align:right;">
1360
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
2020-04-16
</td>
<td style="text-align:right;">
341
</td>
<td style="text-align:right;">
274
</td>
<td style="text-align:right;">
1572
</td>
<td style="text-align:right;">
1634
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
2020-04-17
</td>
<td style="text-align:right;">
266
</td>
<td style="text-align:right;">
329
</td>
<td style="text-align:right;">
1838
</td>
<td style="text-align:right;">
1963
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
2020-04-18
</td>
<td style="text-align:right;">
306
</td>
<td style="text-align:right;">
396
</td>
<td style="text-align:right;">
2144
</td>
<td style="text-align:right;">
2359
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
2020-04-19
</td>
<td style="text-align:right;">
312
</td>
<td style="text-align:right;">
475
</td>
<td style="text-align:right;">
2456
</td>
<td style="text-align:right;">
2834
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
2020-04-20
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
571
</td>
<td style="text-align:right;">
2948
</td>
<td style="text-align:right;">
3405
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
2020-04-21
</td>
<td style="text-align:right;">
434
</td>
<td style="text-align:right;">
686
</td>
<td style="text-align:right;">
3382
</td>
<td style="text-align:right;">
4091
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
2020-04-22
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
825
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4916
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:left;">
2020-04-23
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
990
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5906
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
2020-04-24
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1190
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7096
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:left;">
2020-04-25
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1429
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
8525
</td>
</tr>
</tbody>
</table>
</div>
<div id="projection-for-100-days-into-the-future-1" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Projection for 100 days into the future</h3>
<p>Assuming the situation will remain like this including the interventions currently in place, the 100 day projection suggests that the the peak of the epidemic will be around the middle of June. The trajectory also suggests that the epidemic will end by end of July or early August.</p>
<p><img src="covid19_files/figure-html/projection-bangladesh-graph-100-run2-1.png" width="960" /></p>
<!-- ## Projection for Bangladesh (unofficial) Run 3 {#projection-bangladesh-run3} -->
<!-- __Run date__: 11 May 2020 -->
<!-- This is the third projection. For the initial project, please scroll up. The methodology is discussed above. -->
<!-- ```{r, projection-bangladesh-graph-run3, fig.width=10, fig.height=8, echo = FALSE, warning=FALSE, cache=TRUE, message=FALSE} -->
<!-- run_date = ymd("2020-05-11") -->
<!-- a1 <- fit_seir(country = "Bangladesh(unoff)",  af=.25, nfuture = 5, -->
<!--                run_date = run_date) -->
<!-- p1<- a1$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a1$R0, digit=3),"and","assumsed reporting =", a1$af*100,"%" )) -->
<!-- a2 <- fit_seir(country = "Bangladesh(unoff)", af=.5, nfuture = 5, -->
<!--                run_date = run_date) -->
<!-- p2<- a2$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a2$R0, digit=3),"and","assumsed reporting =", a2$af*100,"%" )) -->
<!-- a3 <- fit_seir(country = "Bangladesh(unoff)", af=.75, nfuture = 5, -->
<!--                run_date = run_date) -->
<!-- p3<- a3$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a3$R0, digit=3),"and","assumsed reporting =", a3$af*100,"%" )) -->
<!-- a4 <- fit_seir(country = "Bangladesh(unoff)", af=.9, nfuture = 5, run_date = run_date) -->
<!-- p4<- a4$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a4$R0, digit=3),"and","assumsed reporting =", a4$af*100,"%" )) -->
<!-- grid.arrange(grobs = list(p1, p2, p3, p4), ncol=2, -->
<!--              top = textGrob(paste0("COVID-19 observed and 5-day projected incidence for Bangladesh (unofficial)\n(orange=actual cases, red=predicted incidence from SEIR model, blue=Exposed, green=Recovered)\n",  today()), -->
<!--              gp=gpar(fontsize=16, font=16))) -->
<!-- ``` -->
<!-- It turns out that the bottom right one fits the current data best. So lets put that figure on a bigger canvas. Please note that in Run 1, we used a similar $R_0$ but a lower ascertainment rate. This time, a higher ascertainment rate is associated with a similar $R_0$. -->
<!-- ```{r, projection-bangladesh-graph-best-run3, fig.width=10, fig.height=8, echo = FALSE, warning=FALSE} -->
<!-- # Plotting the best fit -->
<!-- # p4 + ggtitle(paste0("Best fit model\n(orange=actual cases, red=predicted incidence from SEIR model, blue=Exposed, green=Recovered)", " ", run_date)) -->
<!-- p4 + ggtitle(paste0("Best fit model as of ", run_date, "\n(orange=actual cases, red=predicted incidence from SEIR model, blue=Exposed, green=Recovered)\n", " ","R0 =", format(a4$R0, digit=3)," and ", "assumsed reporting= ", a4$af*100,"%")) -->
<!-- a5 <- fit_seir(country = "Bangladesh(unoff)", af=.96, npast = 0, nfuture = 5, run_date = run_date) -->
<!-- p5<- a5$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a5$R0, digit=3),"and","assumsed reporting =", a5$af*100,"%" )) -->
<!-- p5 -->
<!-- ``` -->
<!-- ### Projection for the next 5 days -->
<!-- ```{r, echo=FALSE, fig.cap="Actual and Predicted Cumulative Cases using SEIR Model"} -->
<!-- a5 <- fit_seir(country = "Bangladesh(unoff)", af=1.1, npast = 0, nfuture = 5, run_date = run_date) -->
<!-- a5$fitted_cases %>% as.data.frame() %>% -->
<!--   mutate( -->
<!--     Date = date, -->
<!--     `Actual daily cases` = c(0, diff(cum_cases)), -->
<!--     `Actual cumulative cases` = cum_cases, -->
<!--     `Projected cumulative cases` = round(I, digits = 0), -->
<!--     `Projected daily cases` = c(0, diff(`Projected cumulative cases`)) -->
<!--   ) %>% -->
<!--   select(Date, `Actual daily cases`, `Projected daily cases`, -->
<!--          `Actual cumulative cases`, -->
<!--           `Projected cumulative cases` ) %>% -->
<!--   tail(12) %>% -->
<!--   kable(format = "html", -->
<!--         caption=paste("Predicted new cases for the next 5 days")) %>% -->
<!--           kable_styling(position = "center") -->
<!-- ``` -->
<!-- ### Projection for 100 days into the future -->
<!-- Assuming the situation will remain like this including the interventions currently in place, the 100 day projection suggests that the the peak of the epidemic will be around the middle of June. The trajectory also suggests that the epidemic will end by end of July or early August. -->
<!-- ```{r, projection-bangladesh-graph-100-run3, fig.width=10, fig.height=8, echo = FALSE, warning=FALSE, cache=TRUE, message=FALSE} -->
<!-- nfuture=100 -->
<!-- a1 <- fit_seir(country = "Bangladesh(unoff)", af=.25, nfuture = nfuture, run_date = run_date) -->
<!-- p1<- a1$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   # geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a1$R0, digit=3),"and","assumsed reporting =", a1$af*100,"%" )) -->
<!-- a2 <- fit_seir(country = "Bangladesh(unoff)", af=.5, nfuture = nfuture) -->
<!-- p2<- a2$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   # geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a2$R0, digit=3),"and","assumsed reporting =", a2$af*100,"%" )) -->
<!-- a3 <- fit_seir(country = "Bangladesh(unoff)", af=.75, nfuture = nfuture) -->
<!-- p3<- a3$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   # geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a3$R0, digit=3),"and","assumsed reporting =", a3$af*100,"%" )) -->
<!-- a4 <- fit_seir(country = "Bangladesh(unoff)", af=1.1, nfuture = nfuture) -->
<!-- p4<- a4$fitted_cases %>% -->
<!--   ggplot(aes(x = date)) + -->
<!--   geom_line(aes(y = I), colour = "red") + -->
<!--   geom_line(aes(y = E), colour = "blue") + -->
<!--   # geom_line(aes(y = R), colour = "darkgreen") + -->
<!--   geom_point(aes(y = cum_cases), colour = "orange") + -->
<!--   scale_y_continuous(labels = scales::comma) + -->
<!--   # scale_y_continuous(labels = scales::comma, trans = 'log') + -->
<!--   labs(y = "Cumulative incidence", -->
<!--        title = paste("R0 =", format(a4$R0, digit=3),"and","assumsed reporting =", a4$af*100,"%" )) -->
<!-- grid.arrange(grobs = list(p1, p2, p3, p4), ncol=2, -->
<!--              top = textGrob(paste0("COVID-19 observed and 100-day projected  incidence for Bangladesh (unofficial)\n(orange=actual cases, red=predicted incidence from SEIR model, blue=Exposed)\n",  today()), -->
<!--              gp=gpar(fontsize=16, font=16))) -->
<!-- # grid.arrange(a, b, c, d,ncol=2, -->
<!-- #      nrow=2, top=textGrob("Title", gp=gpar(fontsize=15,font=8))) -->
<!-- ``` -->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-churches2020covid19rpart1">
<p>Churches, Tim. 2020. “Tim Churches Health Data Science Blog: Analysing Covid-19 (2019-nCoV) Outbreak Data with R - Part 1.” <a href="https://timchurches.github.io/blog/posts/2020-02-18-analysing-covid-19-2019-ncov-outbreak-data-with-r-part-1/" class="uri">https://timchurches.github.io/blog/posts/2020-02-18-analysing-covid-19-2019-ncov-outbreak-data-with-r-part-1/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bangladesh.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="scipubs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-projections.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["covid19.pdf", "covid19.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
